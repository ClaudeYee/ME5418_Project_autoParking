/home/neptron/anaconda3/envs/me5418project/bin/python /home/neptron/PycharmProjects/ME5418_Project_autoParking/ppo_agent.py
not stuck
Not available, retry to place two parkinglots
not stuck
Collect data into a buffer
total time steps run 0
time steps added to buffer 0
actor_net:  cuda:0
The steps in this episode have exceeded the episode length we set, task failed.
Episode 0 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 0
time steps added to buffer 128
actor_net:  cuda:0
The steps in this episode have exceeded the episode length we set, task failed.
Episode 1 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 0
time steps added to buffer 256
actor_net:  cuda:0
The steps in this episode have exceeded the episode length we set, task failed.
Episode 2 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 0
time steps added to buffer 384
actor_net:  cuda:0
The steps in this episode have exceeded the episode length we set, task failed.
Episode 3 runs 128 steps
not stuck
data has been collected into one rollout
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
not stuck
Collect data into a buffer
total time steps run 512
time steps added to buffer 0
actor_net:  cuda:0
The steps in this episode have exceeded the episode length we set, task failed.
Episode 0 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 512
time steps added to buffer 128
actor_net:  cuda:0
The steps in this episode have exceeded the episode length we set, task failed.
Episode 1 runs 128 steps
will stuck
not available
not stuck
Collect data into a buffer
total time steps run 512
time steps added to buffer 256
actor_net:  cuda:0
The steps in this episode have exceeded the episode length we set, task failed.
Episode 2 runs 128 steps
will stuck
not available
will stuck
not available
not stuck
Collect data into a buffer
total time steps run 512
time steps added to buffer 384
actor_net:  cuda:0
The steps in this episode have exceeded the episode length we set, task failed.
Episode 3 runs 128 steps
will stuck
not available
not stuck
data has been collected into one rollout
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Not available, retry to place two parkinglots
Not available, retry to place two parkinglots
not stuck
Collect data into a buffer
total time steps run 1024
time steps added to buffer 0
actor_net:  cuda:0
The steps in this episode have exceeded the episode length we set, task failed.
Episode 0 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 1024
time steps added to buffer 128
actor_net:  cuda:0
The steps in this episode have exceeded the episode length we set, task failed.
Episode 1 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 1024
time steps added to buffer 256
actor_net:  cuda:0
The steps in this episode have exceeded the episode length we set, task failed.
Episode 2 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 1024
time steps added to buffer 384
actor_net:  cuda:0
The steps in this episode have exceeded the episode length we set, task failed.
Episode 3 runs 128 steps
not stuck
data has been collected into one rollout
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
will stuck
not available
not stuck
Collect data into a buffer
total time steps run 1536
time steps added to buffer 0
actor_net:  cuda:0
valid_action number 36
total_probability:  tensor(2.8243e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 27
total_probability:  tensor(8.4646e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8221e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8315e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8194e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8221e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8180e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8366e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8265e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8285e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8235e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8298e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8244e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 0 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 1536
time steps added to buffer 128
actor_net:  cuda:0
valid_action number 36
total_probability:  tensor(2.8266e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8262e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8266e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8194e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8242e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8346e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8240e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8208e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8210e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8236e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8165e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8306e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8265e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 1 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 1536
time steps added to buffer 256
actor_net:  cuda:0
The steps in this episode have exceeded the episode length we set, task failed.
Episode 2 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 1536
time steps added to buffer 384
actor_net:  cuda:0
valid_action number 36
total_probability:  tensor(2.8313e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8278e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8212e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8365e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 27
total_probability:  tensor(8.4759e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8314e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 27
total_probability:  tensor(8.4636e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8160e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8295e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8235e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 36
total_probability:  tensor(2.8219e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 3 runs 128 steps
not stuck
data has been collected into one rollout
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
not stuck
Collect data into a buffer
total time steps run 2048
time steps added to buffer 0
actor_net:  cuda:0
valid_action number 27
total_probability:  tensor(9.6112e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7617e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7563e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7669e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7587e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7452e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 0 runs 128 steps
will stuck
not available
not stuck
Collect data into a buffer
total time steps run 2048
time steps added to buffer 128
actor_net:  cuda:0
valid_action number 33
total_probability:  tensor(9.8195e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7724e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7587e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7710e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7610e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7775e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 1 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 2048
time steps added to buffer 256
actor_net:  cuda:0
valid_action number 46
total_probability:  tensor(1.7938e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.7956e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.7936e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.7906e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7568e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.7963e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.7940e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.1683e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.7944e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7399e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7583e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 2 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 2048
time steps added to buffer 384
actor_net:  cuda:0
valid_action number 33
total_probability:  tensor(9.7477e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7548e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7820e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7466e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7709e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(9.7550e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.7917e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.7899e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 26
total_probability:  tensor(5.9861e-12, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.7892e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.7956e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 26
total_probability:  tensor(5.9840e-12, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.7917e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.1670e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.7881e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 3 runs 128 steps
not stuck
data has been collected into one rollout
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Not available, retry to place two parkinglots
Not available, retry to place two parkinglots
Not available, retry to place two parkinglots
Not available, retry to place two parkinglots
Not available, retry to place two parkinglots
Not available, retry to place two parkinglots
Not available, retry to place two parkinglots
not stuck
Collect data into a buffer
total time steps run 2560
time steps added to buffer 0
actor_net:  cuda:0
valid_action number 33
total_probability:  tensor(8.7862e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7879e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7902e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7929e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 0 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 2560
time steps added to buffer 128
actor_net:  cuda:0
valid_action number 33
total_probability:  tensor(8.7920e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7855e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7881e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7756e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.6116e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.0504e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.6123e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.0498e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 26
total_probability:  tensor(5.3592e-12, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.0504e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.6101e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.6120e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.6117e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 1 runs 128 steps
will stuck
not available
not stuck
Collect data into a buffer
total time steps run 2560
time steps added to buffer 256
actor_net:  cuda:0
valid_action number 33
total_probability:  tensor(8.7867e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7825e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7869e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7881e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7856e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7824e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 2 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 2560
time steps added to buffer 384
actor_net:  cuda:0
valid_action number 33
total_probability:  tensor(8.7838e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7823e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7827e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7833e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7841e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7879e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7844e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.7872e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.6111e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.6127e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.6111e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.6113e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.0504e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 3 runs 128 steps
not stuck
data has been collected into one rollout
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
not stuck
Collect data into a buffer
total time steps run 3072
time steps added to buffer 0
actor_net:  cuda:0
valid_action number 10
total_probability:  tensor(1.9706e-12, device='cuda:0', grad_fn=<SumBackward0>)
/home/neptron/PycharmProjects/ME5418_Project_autoParking/Auto_Parking.py:456: RuntimeWarning: invalid value encountered in divide
  sin_to_pklot2 = np.cross(vector_to_pklot2, move_vector) / (np.linalg.norm(move_vector) * np.linalg.norm(vector_to_pklot2))
valid_action number 10
total_probability:  tensor(1.9688e-12, device='cuda:0', grad_fn=<SumBackward0>)
The robot has successfully parked in the parking lot, task succeeded!
Episode 0 runs 37 steps
not stuck
Collect data into a buffer
total time steps run 3072
time steps added to buffer 37
actor_net:  cuda:0
valid_action number 33
total_probability:  tensor(8.6239e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6237e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6274e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5798e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5806e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5811e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.0312e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 26
total_probability:  tensor(5.2528e-12, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.0319e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5821e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5823e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5806e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 26
total_probability:  tensor(5.2497e-12, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5815e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5844e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5809e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5822e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5817e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5802e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5827e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 26
total_probability:  tensor(5.2457e-12, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.0340e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5807e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5814e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5839e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5836e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.0326e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5839e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5821e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.0330e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.0302e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5820e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 26
total_probability:  tensor(5.2417e-12, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5818e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6237e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 1 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 3072
time steps added to buffer 165
actor_net:  cuda:0
valid_action number 33
total_probability:  tensor(8.6370e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6361e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6284e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6540e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6336e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 20
total_probability:  tensor(4.6810e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 20
total_probability:  tensor(4.6805e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 20
total_probability:  tensor(4.6854e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 20
total_probability:  tensor(4.6836e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 20
total_probability:  tensor(4.6814e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 20
total_probability:  tensor(4.6861e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 20
total_probability:  tensor(4.6787e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 20
total_probability:  tensor(4.6829e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 20
total_probability:  tensor(4.6826e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 20
total_probability:  tensor(4.6844e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 20
total_probability:  tensor(4.6861e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 20
total_probability:  tensor(4.6841e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 2 runs 128 steps
not stuck
Collect data into a buffer
total time steps run 3072
time steps added to buffer 293
actor_net:  cuda:0
valid_action number 33
total_probability:  tensor(8.6373e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6162e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6239e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6285e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6287e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5822e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5821e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 3 runs 128 steps
not available
will stuck
not available
not stuck
Collect data into a buffer
total time steps run 3072
time steps added to buffer 421
actor_net:  cuda:0
valid_action number 33
total_probability:  tensor(8.6302e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6395e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6322e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 33
total_probability:  tensor(8.6321e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.0300e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5805e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5816e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.0315e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5811e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5811e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5820e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5824e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5813e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5815e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5838e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 25
total_probability:  tensor(1.0324e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 26
total_probability:  tensor(5.2595e-12, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5831e-11, device='cuda:0', grad_fn=<SumBackward0>)
valid_action number 46
total_probability:  tensor(1.5828e-11, device='cuda:0', grad_fn=<SumBackward0>)
The steps in this episode have exceeded the episode length we set, task failed.
Episode 4 runs 128 steps
not stuck
data has been collected into one rollout
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Starts to divide buffer into mini batches.
Not available, retry to place two parkinglots
Not available, retry to place two parkinglots
Not available, retry to place two parkinglots
Not available, retry to place two parkinglots
not stuck
Collect data into a buffer
total time steps run 3584
time steps added to buffer 37
actor_net:  cuda:0
Traceback (most recent call last):
  File "/home/neptron/PycharmProjects/ME5418_Project_autoParking/ppo_agent.py", line 326, in <module>
    agent.learn(10000)
  File "/home/neptron/PycharmProjects/ME5418_Project_autoParking/ppo_agent.py", line 144, in learn
    t = self.env.run_episode(self.actor_net, t, total_episode_index)
  File "/home/neptron/PycharmProjects/ME5418_Project_autoParking/Auto_Parking.py", line 405, in run_episode
    robot_state, state, reward, done, valid_action = self.step(actor_net=actor_net, robot_state=robot_state, done=done)
  File "/home/neptron/PycharmProjects/ME5418_Project_autoParking/Auto_Parking.py", line 374, in step
    state, action_index, log_prob, valid_action = self.act(actor_net, robot_state)
  File "/home/neptron/PycharmProjects/ME5418_Project_autoParking/Auto_Parking.py", line 538, in act
    action_distribution = Categorical(normalized_probabilities)
  File "/home/neptron/anaconda3/envs/me5418project/lib/python3.9/site-packages/torch/distributions/categorical.py", line 70, in __init__
    super().__init__(batch_shape, validate_args=validate_args)
  File "/home/neptron/anaconda3/envs/me5418project/lib/python3.9/site-packages/torch/distributions/distribution.py", line 68, in __init__
    raise ValueError(
ValueError: Expected parameter probs (Tensor of shape (1, 81)) of distribution Categorical(probs: torch.Size([1, 81])) to satisfy the constraint Simplex(), but found invalid values:
tensor([[nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan,
         nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan,
         nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan,
         nan, nan, nan, nan, nan, nan, nan, nan, nan]], device='cuda:0',
       grad_fn=<DivBackward0>)

进程已结束，退出代码为 1